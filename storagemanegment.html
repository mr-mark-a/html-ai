<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Local Storage Manager</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 20px;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
            background: white;
            border-radius: 15px;
            box-shadow: 0 20px 60px rgba(0, 0, 0, 0.3);
            overflow: hidden;
        }

        .header {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 30px;
            text-align: center;
        }

        .header h1 {
            font-size: 2.5em;
            margin-bottom: 10px;
        }

        .header p {
            font-size: 1.1em;
            opacity: 0.9;
        }

        .controls {
            padding: 20px 30px;
            background: #f8f9fa;
            border-bottom: 2px solid #e9ecef;
            display: flex;
            justify-content: space-between;
            align-items: center;
            flex-wrap: wrap;
            gap: 15px;
        }

        .stats {
            display: flex;
            gap: 20px;
            flex-wrap: wrap;
        }

        .stat-item {
            background: white;
            padding: 10px 20px;
            border-radius: 8px;
            box-shadow: 0 2px 5px rgba(0, 0, 0, 0.1);
        }

        .stat-item strong {
            color: #667eea;
            font-size: 1.2em;
        }

        .btn {
            padding: 12px 25px;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            font-size: 1em;
            font-weight: 600;
            transition: all 0.3s ease;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }

        .btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.2);
        }

        .btn-refresh {
            background: #667eea;
            color: white;
        }

        .btn-clear-all {
            background: #dc3545;
            color: white;
        }

        .btn-export {
            background: #28a745;
            color: white;
        }

        .btn-apply {
            background: #ff6b6b;
            color: white;
            animation: pulse 2s infinite;
        }

        @keyframes pulse {
            0%, 100% { transform: scale(1); }
            50% { transform: scale(1.05); }
        }

        .apply-banner {
            background: linear-gradient(135deg, #ff6b6b 0%, #ee5a6f 100%);
            color: white;
            padding: 15px 30px;
            display: none;
            justify-content: space-between;
            align-items: center;
            border-bottom: 2px solid #e74c3c;
        }

        .apply-banner.show {
            display: flex;
        }

        .apply-banner-text {
            font-size: 1.1em;
            font-weight: 600;
        }

        .content {
            padding: 30px;
        }

        .search-box {
            margin-bottom: 20px;
            position: relative;
        }

        .search-box input {
            width: 100%;
            padding: 15px 45px 15px 20px;
            border: 2px solid #e9ecef;
            border-radius: 10px;
            font-size: 1em;
            transition: border-color 0.3s ease;
        }

        .search-box input:focus {
            outline: none;
            border-color: #667eea;
        }

        .search-icon {
            position: absolute;
            right: 15px;
            top: 50%;
            transform: translateY(-50%);
            color: #adb5bd;
            font-size: 1.2em;
        }

        .storage-items {
            display: grid;
            gap: 20px;
        }

        .storage-item {
            background: #f8f9fa;
            border: 2px solid #e9ecef;
            border-radius: 10px;
            padding: 20px;
            transition: all 0.3s ease;
        }

        .storage-item:hover {
            border-color: #667eea;
            box-shadow: 0 5px 15px rgba(102, 126, 234, 0.2);
        }

        .item-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 15px;
            flex-wrap: wrap;
            gap: 10px;
        }

        .item-key {
            font-size: 1.2em;
            font-weight: 700;
            color: #495057;
            word-break: break-word;
        }

        .item-actions {
            display: flex;
            gap: 10px;
        }

        .btn-small {
            padding: 8px 15px;
            font-size: 0.9em;
            border: none;
            border-radius: 6px;
            cursor: pointer;
            font-weight: 600;
            transition: all 0.3s ease;
        }

        .btn-view {
            background: #17a2b8;
            color: white;
        }

        .btn-copy {
            background: #ffc107;
            color: #212529;
        }

        .btn-delete {
            background: #dc3545;
            color: white;
        }

        .btn-edit {
            background: #6f42c1;
            color: white;
        }

        .btn-save {
            background: #28a745;
            color: white;
        }

        .btn-cancel {
            background: #6c757d;
            color: white;
        }

        .btn-small:hover {
            transform: translateY(-2px);
            box-shadow: 0 3px 10px rgba(0, 0, 0, 0.2);
        }

        .item-value {
            background: white;
            padding: 15px;
            border-radius: 8px;
            border-left: 4px solid #667eea;
            font-family: 'Courier New', monospace;
            font-size: 0.95em;
            max-height: 200px;
            overflow-y: auto;
            word-break: break-all;
            white-space: pre-wrap;
        }

        .item-value.editing {
            background: #fff3cd;
            border-left-color: #ffc107;
        }

        .item-value textarea {
            width: 100%;
            min-height: 150px;
            padding: 10px;
            border: 2px solid #ffc107;
            border-radius: 5px;
            font-family: 'Courier New', monospace;
            font-size: 0.95em;
            resize: vertical;
        }

        .storage-item.modified {
            border-color: #ff6b6b;
            background: #fff5f5;
        }

        .item-meta {
            display: flex;
            gap: 20px;
            margin-top: 10px;
            font-size: 0.9em;
            color: #6c757d;
        }

        .credential-badge {
            display: inline-block;
            padding: 4px 10px;
            border-radius: 5px;
            font-size: 0.85em;
            font-weight: 600;
            margin-left: 10px;
        }

        .badge-password {
            background: #dc3545;
            color: white;
        }

        .badge-token {
            background: #ffc107;
            color: #212529;
        }

        .badge-user {
            background: #17a2b8;
            color: white;
        }

        .badge-auth {
            background: #6f42c1;
            color: white;
        }

        .category-section {
            margin-bottom: 30px;
        }

        .category-header {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 15px 20px;
            border-radius: 8px;
            margin-bottom: 15px;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .category-header h3 {
            font-size: 1.3em;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .category-count {
            background: rgba(255, 255, 255, 0.2);
            padding: 5px 15px;
            border-radius: 20px;
            font-size: 0.9em;
        }

        .empty-state {
            text-align: center;
            padding: 60px 20px;
            color: #6c757d;
        }

        .empty-state svg {
            width: 100px;
            height: 100px;
            margin-bottom: 20px;
            opacity: 0.5;
        }

        .empty-state h2 {
            font-size: 1.8em;
            margin-bottom: 10px;
        }

        .modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.7);
            z-index: 1000;
            justify-content: center;
            align-items: center;
        }

        .modal.active {
            display: flex;
        }

        .modal-content {
            background: white;
            padding: 30px;
            border-radius: 15px;
            max-width: 800px;
            width: 90%;
            max-height: 80vh;
            overflow-y: auto;
            position: relative;
            animation: slideIn 0.3s ease;
        }

        @keyframes slideIn {
            from {
                transform: translateY(-50px);
                opacity: 0;
            }
            to {
                transform: translateY(0);
                opacity: 1;
            }
        }

        .modal-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
            padding-bottom: 15px;
            border-bottom: 2px solid #e9ecef;
        }

        .modal-header h2 {
            color: #495057;
            font-size: 1.5em;
        }

        .btn-close {
            background: none;
            border: none;
            font-size: 2em;
            cursor: pointer;
            color: #adb5bd;
            transition: color 0.3s ease;
            padding: 0;
            width: 30px;
            height: 30px;
            line-height: 1;
        }

        .btn-close:hover {
            color: #495057;
        }

        .formatted-json {
            background: #f8f9fa;
            padding: 20px;
            border-radius: 8px;
            border-left: 4px solid #667eea;
            font-family: 'Courier New', monospace;
            font-size: 0.95em;
            overflow-x: auto;
            white-space: pre;
        }

        .toast {
            position: fixed;
            bottom: 30px;
            right: 30px;
            background: #28a745;
            color: white;
            padding: 15px 25px;
            border-radius: 8px;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.3);
            display: none;
            animation: slideUp 0.3s ease;
            z-index: 2000;
        }

        .toast.show {
            display: block;
        }

        @keyframes slideUp {
            from {
                transform: translateY(100px);
                opacity: 0;
            }
            to {
                transform: translateY(0);
                opacity: 1;
            }
        }

        @media (max-width: 768px) {
            .header h1 {
                font-size: 1.8em;
            }

            .controls {
                flex-direction: column;
                align-items: stretch;
            }

            .stats {
                justify-content: center;
            }

            .btn {
                width: 100%;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>üóÑÔ∏è Local Storage Manager</h1>
            <p>View, manage, and delete all your browser's local storage data</p>
            <div style="margin-top: 15px;">
                <button onclick="window.location.href='marks-games.html'" style="background: rgba(255,255,255,0.2); border: 2px solid white; color: white; padding: 10px 20px; border-radius: 8px; cursor: pointer; font-size: 1em; font-weight: 600; transition: all 0.3s ease;" onmouseover="this.style.background='rgba(255,255,255,0.3)'" onmouseout="this.style.background='rgba(255,255,255,0.2)'">
                    ‚Üê Back to Games Menu
                </button>
            </div>
        </div>

        <div class="controls">
            <div class="stats">
                <div class="stat-item">
                    <span>Items: <strong id="itemCount">0</strong></span>
                </div>
                <div class="stat-item">
                    <span>Total Size: <strong id="totalSize">0 KB</strong></span>
                </div>
            </div>
            <div style="display: flex; gap: 10px; flex-wrap: wrap;">
                <button class="btn btn-refresh" onclick="loadStorage()">üîÑ Refresh</button>
                <button class="btn btn-export" onclick="exportStorage()">üíæ Export</button>
                <button class="btn btn-clear-all" onclick="clearAllStorage()">üóëÔ∏è Clear All</button>
            </div>
        </div>

        <div class="apply-banner" id="applyBanner">
            <div class="apply-banner-text">
                ‚ö†Ô∏è You have unsaved changes! Click Apply to save them to storage.
            </div>
            <div style="display: flex; gap: 10px;">
                <button class="btn btn-apply" onclick="applyChanges()">‚úÖ Apply Changes</button>
                <button class="btn btn-refresh" onclick="discardChanges()">‚Ü©Ô∏è Discard</button>
            </div>
        </div>

        <div class="content">
            <div class="search-box">
                <input type="text" id="searchInput" placeholder="Search by key name..." onkeyup="filterItems()">
                <span class="search-icon">üîç</span>
            </div>

            <div class="storage-items" id="storageContainer"></div>
        </div>
    </div>

    <div class="modal" id="viewModal">
        <div class="modal-content">
            <div class="modal-header">
                <h2 id="modalTitle">View Data</h2>
                <button class="btn-close" onclick="closeModal()">&times;</button>
            </div>
            <div id="modalBody"></div>
        </div>
    </div>

    <div class="toast" id="toast"></div>

    <script>
        // Track pending changes
        let pendingChanges = {};

        // Load storage on page load
        document.addEventListener('DOMContentLoaded', loadStorage);

        function loadStorage() {
            const container = document.getElementById('storageContainer');
            const itemCount = document.getElementById('itemCount');
            const totalSize = document.getElementById('totalSize');

            // Clear container
            container.innerHTML = '';

            // Get all localStorage items
            const items = [];
            let totalBytes = 0;

            for (let i = 0; i < localStorage.length; i++) {
                const key = localStorage.key(i);
                const value = localStorage.getItem(key);
                const size = new Blob([value]).size;
                totalBytes += size;

                items.push({ key, value, size });
            }

            // Update stats
            itemCount.textContent = items.length;
            totalSize.textContent = (totalBytes / 1024).toFixed(2) + ' KB';

            // Display items
            if (items.length === 0) {
                container.innerHTML = `
                    <div class="empty-state">
                        <svg viewBox="0 0 24 24" fill="none" stroke="currentColor">
                            <path d="M20 7h-9M14 17H6a2 2 0 01-2-2V5a2 2 0 012-2h12a2 2 0 012 2v10a2 2 0 01-2 2z" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                        </svg>
                        <h2>No Data Found</h2>
                        <p>Your local storage is currently empty</p>
                    </div>
                `;
            } else {
                // Categorize items
                const categories = {
                    credentials: [],
                    authentication: [],
                    userData: [],
                    settings: [],
                    other: []
                };

                items.forEach(item => {
                    const keyLower = item.key.toLowerCase();
               Detect credential type
            const keyLower = key.toLowerCase();
            let badge = '';
            if (keyLower.includes('pass') || keyLower.includes('pwd')) {
                badge = '<span class="credential-badge badge-password">üîí PASSWORD</span>';
            } else if (keyLower.includes('token') || keyLower.includes('jwt')) {
                badge = '<span class="credential-badge badge-token">üé´ TOKEN</span>';
            } else if (keyLower.includes('user') || keyLower.includes('login') || keyLower.includes('email') || keyLower.includes('robot')) {
                badge = '<span class="credential-badge badge-user">üë§ USER</span>';
            } else if (keyLower.includes('auth') || keyLower.includes('session')) {
                badge = '<span class="credential-badge badge-auth">üîê AUTH</span>';
            }

            // Try to format the value preview
            let preview = value;
            let isJSON = false;
            try {
                const parsed = JSON.parse(value);
                isJSON = true;
                // For JSON objects, try to show key fields
                if (typeof parsed === 'object' && parsed !== null) {
                    const keys = Object.keys(parsed);
                    if (keys.length > 0) {
                        let previewObj = {};
                        keys.slice(0, 5).forEach(k => previewObj[k] = parsed[k]);
                        preview = JSON.stringify(previewObj, null, 2);
                        if (keys.length > 5) preview += '\n... (more fields)';
                    } else {
                        preview = JSON.stringify(parsed);
                    }
                } else {
                    preview = JSON.stringify(parsed);
                }
            } catch (e) {
                preview = value.substring(0, 300) + (value.length > 300 ? '...' : '');
            }

            div.innerHTML = `
                <div class="item-header">
                    <div class="item-key">${escapeHtml(key)}${badge
                // Display categorized items
                if (categories.credentials.length > 0) {
                    container.appendChild(createCategorySection('üîê Passwords & Credentials', categories.credentials, 'credentials'));
                }
                if (categories.authentication.length > 0) {
                    container.appendChild(createCategorySection('üé´ Authentication & Tokens', categories.authentication, 'authentication'));
                }
                if (categories.userData.length > 0) {
                    container.appendChild(createCategorySection('üë§ User Data & Accounts', categories.userData, 'userData'));
                }
                if (categories.settings.length > 0) {
                    container.appendChild(createCategorySection('‚öôÔ∏è Settings & Configuration', categories.settings, 'settings'));
                }
                if (categories.other.length > 0) {
                    container.appendChild(createCategorySection('üì¶ Other Data', categories.other, 'other'));
                }
            }
        }

        function createCategorySection(title, items, categoryId) {
            const section = document.createElement('div');
            section.className = 'category-section';
            section.dataset.category = categoryId;

            const header = document.createElement('div');
            header.className = 'category-header';
            header.innerHTML = `
                <h3>${title}</h3>
                <span class="category-count">${items.length} item${items.length !== 1 ? 's' : ''}</span>
            `;

            section.appendChild(header);

            items.forEach(item => {
                section.appendChild(createStorageItem(item));
            });

            return section;
        }

        function createStorageItem({ key, value, size }) {
            const div = document.createElement('div');
            div.className = 'storage-item';
            div.dataset.key = key.toLowerCase();

            // Try to format the value preview
            let preview = value;
            let isJSON = false;
            try {
                JSON.parse(value);
                isJSON = true;
                preview = value.substring(0, 200) + (value.length > 200 ? '...' : '');
            } catch (e) {
                preview = value.substring(0, 200) + (value.length > 200 ? '...' : '');
            }

            div.innerHTML = `
                <div class="item-header">
                    <div class="item-key">${escapeHtml(key)}</div>
                    <div class="item-actions">
                        <button class="btn-small btn-view" onclick="viewItem('${escapeHtml(key)}')">
                            üëÅÔ∏è View
                        </button>
                        <button class="btn-small btn-edit" onclick="editItem('${escapeHtml(key)}')">
                            ‚úèÔ∏è Edit
                        </button>
                        <button class="btn-small btn-copy" onclick="copyItem('${escapeHtml(key)}')">
                            üìã Copy
                        </button>
                        <button class="btn-small btn-delete" onclick="deleteItem('${escapeHtml(key)}')">
                            üóëÔ∏è Delete
                        </button>
                    </div>
                </div>
                <div class="item-value">${escapeHtml(preview)}</div>
                <div class="item-meta">
                    <span>üìè Size: <strong>${(size / 1024).toFixed(2)} KB</strong></span>
                    <span>üìù Length: <strong>${value.length} chars</strong></span>
                    ${isJSON ? '<span>üîñ Type: <strong>JSON</strong></span>' : '<span>üîñ Type: <strong>String</strong></span>'}
                </div>
            `;

            return div;
        }

        function viewItem(key) {
            const value = localStorage.getItem(key);
            const modal = document.getElementById('viewModal');
            const modalTitle = document.getElementById('modalTitle');
            const categories = document.querySelectorAll('.category-section');

            items.forEach(item => {
                const key = item.dataset.key;
                if (key.includes(searchTerm)) {
                    item.style.display = 'block';
                } else {
                    item.style.display = 'none';
                }
            });

            // Hide categories with no visible items
            categories.forEach(category => {
                const visibleItems = category.querySelectorAll('.storage-item[style="display: block;"], .storage-item:not([style*="display: none"])');
                if (visibleItems.length === 0 && searchTerm !== '') {
                    category.style.display = 'none';
                } else {
                    category.style.display = 'block
                const parsed = JSON.parse(value);
                formattedValue = JSON.stringify(parsed, null, 2);
                modalBody.innerHTML = `
                    <div class="formatted-json">${escapeHtml(formattedValue)}</div>
                    <div style="margin-top: 15px;">
                        <button class="btn btn-copy" onclick="copyToClipboard(\`${escapeHtml(formattedValue)}\`)">
                            üìã Copy Formatted JSON
                        </button>
                    </div>
                `;
            } catch (e) {
                modalBody.innerHTML = `
                    <div class="formatted-json">${escapeHtml(value)}</div>
                    <div style="margin-top: 15px;">
                        <button class="btn btn-copy" onclick="copyToClipboard(\`${escapeHtml(value)}\`)">
                            üìã Copy Value
                        </button>
                    </div>
                `;
            }

            modal.classList.add('active');
        }

        function closeModal() {
            document.getElementById('viewModal').classList.remove('active');
        }

        function copyItem(key) {
            const value = localStorage.getItem(key);
            copyToClipboard(value);
        }

        function copyToClipboard(text) {
            navigator.clipboard.writeText(text).then(() => {
                showToast('‚úÖ Copied to clipboard!');
            }).catch(() => {
                showToast('‚ùå Failed to copy', 'error');
            });
        }

        function editItem(key) {
            const items = document.querySelectorAll('.storage-item');
            items.forEach(item => {
                if (item.dataset.key === key.toLowerCase()) {
                    const valueDiv = item.querySelector('.item-value');
                    const actionsDiv = item.querySelector('.item-actions');
                    const currentValue = localStorage.getItem(key);
                    
                    // Store original value
                    valueDiv.dataset.originalValue = currentValue;
                    
                    // Create textarea for editing
                    valueDiv.innerHTML = `<textarea id="edit-${escapeHtml(key)}">${escapeHtml(currentValue)}</textarea>`;
                    valueDiv.classList.add('editing');
                    
                    // Change buttons to Save/Cancel
                    actionsDiv.innerHTML = `
                        <button class="btn-small btn-save" onclick="saveEdit('${escapeHtml(key)}')">
                            üíæ Save
                        </button>
                        <button class="btn-small btn-cancel" onclick="cancelEdit('${escapeHtml(key)}')">
                            ‚ùå Cancel
                        </button>
                    `;
                }
            });
        }

        function saveEdit(key) {
            const textarea = document.getElementById(`edit-${key}`);
            const newValue = textarea.value;
            
            // Store in pending changes
            pendingChanges[key] = newValue;
            
            // Mark item as modified
            const items = document.querySelectorAll('.storage-item');
            items.forEach(item => {
                if (item.dataset.key === key.toLowerCase()) {
                    item.classList.add('modified');
                    const valueDiv = item.querySelector('.item-value');
                    valueDiv.classList.remove('editing');
                    
                    // Show preview of new value
                    let preview = newValue.substring(0, 300) + (newValue.length > 300 ? '...' : '');
                    valueDiv.innerHTML = escapeHtml(preview);
                    
                    // Restore action buttons
                    const actionsDiv = item.querySelector('.item-actions');
                    actionsDiv.innerHTML = `
                        <button class="btn-small btn-view" onclick="viewItem('${escapeHtml(key)}')">
                            üëÅÔ∏è View
                        </button>
                        <button class="btn-small btn-edit" onclick="editItem('${escapeHtml(key)}')">
                            ‚úèÔ∏è Edit
                        </button>
                        <button class="btn-small btn-copy" onclick="copyItem('${escapeHtml(key)}')">
                            üìã Copy
                        </button>
                        <button class="btn-small btn-delete" onclick="deleteItem('${escapeHtml(key)}')">
                            üóëÔ∏è Delete
                        </button>
                    `;
                }
            });
            
            // Show apply banner
            showApplyBanner();
            showToast('‚úèÔ∏è Edit saved (not applied yet)');
        }

        function cancelEdit(key) {
            const items = document.querySelectorAll('.storage-item');
            items.forEach(item => {
                if (item.dataset.key === key.toLowerCase()) {
                    const valueDiv = item.querySelector('.item-value');
                    const originalValue = valueDiv.dataset.originalValue;
                    
                    valueDiv.classList.remove('editing');
                    let preview = originalValue.substring(0, 300) + (originalValue.length > 300 ? '...' : '');
                    valueDiv.innerHTML = escapeHtml(preview);
                    
                    // Restore action buttons
                    const actionsDiv = item.querySelector('.item-actions');
                    actionsDiv.innerHTML = `
                        <button class="btn-small btn-view" onclick="viewItem('${escapeHtml(key)}')">
                            üëÅÔ∏è View
                        </button>
                        <button class="btn-small btn-edit" onclick="editItem('${escapeHtml(key)}')">
                            ‚úèÔ∏è Edit
                        </button>
                        <button class="btn-small btn-copy" onclick="copyItem('${escapeHtml(key)}')">
                            üìã Copy
                        </button>
                        <button class="btn-small btn-delete" onclick="deleteItem('${escapeHtml(key)}')">
                            üóëÔ∏è Delete
                        </button>
                    `;
                }
            });
        }

        function applyChanges() {
            const changeCount = Object.keys(pendingChanges).length;
            if (changeCount === 0) {
                showToast('‚ÑπÔ∏è No changes to apply');
                return;
            }

            // Apply all pending changes to localStorage
            for (const [key, value] of Object.entries(pendingChanges)) {
                localStorage.setItem(key, value);
            }

            showToast(`‚úÖ Applied ${changeCount} change${changeCount !== 1 ? 's' : ''} to storage!`);
            
            // Clear pending changes
            pendingChanges = {};
            hideApplyBanner();
            
            // Reload to show updated data
            loadStorage();
        }

        function discardChanges() {
            if (confirm('Are you sure you want to discard all unsaved changes?')) {
                pendingChanges = {};
                hideApplyBanner();
                loadStorage();
                showToast('‚Ü©Ô∏è Changes discarded');
            }
        }

        function showApplyBanner() {
            document.getElementById('applyBanner').classList.add('show');
        }

        function hideApplyBanner() {
            document.getElementById('applyBanner').classList.remove('show');
        }

        function deleteItem(key) {
            if (confirm(`Are you sure you want to delete "${key}"?`)) {
                localStorage.removeItem(key);
                // Also remove from pending changes if it was there
                delete pendingChanges[key];
                if (Object.keys(pendingChanges).length === 0) {
                    hideApplyBanner();
                }
                showToast(`‚úÖ Deleted: ${key}`);
                loadStorage();
            }
        }

        function clearAllStorage() {
            if (confirm('‚ö†Ô∏è Are you sure you want to delete ALL local storage data? This cannot be undone!')) {
                localStorage.clear();
                showToast('‚úÖ All storage cleared!');
                loadStorage();
            }
        }

        function exportStorage() {
            const data = {};
            for (let i = 0; i < localStorage.length; i++) {
                const key = localStorage.key(i);
                data[key] = localStorage.getItem(key);
            }

            const json = JSON.stringify(data, null, 2);
            const blob = new Blob([json], { type: 'application/json' });
            const url = URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = `localStorage-backup-${new Date().toISOString().split('T')[0]}.json`;
            a.click();
            URL.revokeObjectURL(url);
            showToast('‚úÖ Storage exported!');
        }

        function filterItems() {
            const searchTerm = document.getElementById('searchInput').value.toLowerCase();
            const items = document.querySelectorAll('.storage-item');

            items.forEach(item => {
                const key = item.dataset.key;
                if (key.includes(searchTerm)) {
                    item.style.display = 'block';
                } else {
                    item.style.display = 'none';
                }
            });
        }

        function showToast(message, type = 'success') {
            const toast = document.getElementById('toast');
            toast.textContent = message;
            toast.style.background = type === 'error' ? '#dc3545' : '#28a745';
            toast.classList.add('show');

            setTimeout(() => {
                toast.classList.remove('show');
            }, 3000);
        }

        function escapeHtml(text) {
            const div = document.createElement('div');
            div.textContent = text;
            return div.innerHTML;
        }

        // Close modal when clicking outside
        document.getElementById('viewModal').addEventListener('click', function(e) {
            if (e.target === this) {
                closeModal();
            }
        });

        // Close modal with ESC key
        document.addEventListener('keydown', function(e) {
            if (e.key === 'Escape') {
                closeModal();
            }
        });
    </script>
</body>
</html>
